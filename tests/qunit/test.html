<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<html>

<head>
	<title>Formulas test</title>
	<!--<link rel="stylesheet" href="../../lib/unit.css" type="text/css" />
	<script type="text/javascript" src="../../lib/jquery.js"></script>
	<script type="text/javascript" src="../../lib/qunit.js"></script>-->
	<script type="text/javascript" src="../../naturaleditor.js"></script>
	<link rel="stylesheet" href="../../style/styles.css" type="text/css" />
	<!--<script type="text/javascript" src="tool.js"></script>-->
</head>

<body>
	<span id = "frame">
		<span>
			<table border="1">
				<tbody>
					<tr>
					</tr>
					<tr>
						<td>
							<div id="naturaleditor" style="overflow:auto; position:relative; width:600px; height:200px">
						    <p>
						    	<svg width='100px' height='100px'>
						    		<g>
						    			<rect width="8px" height="8px"></rect>
						    		</g>
						    	</svg>
						    </p>
						  </div>
					  </td>
					</tr>
				</tbody>
			</table>
		</span>
	</span>
	
	<script type="text/javascript">
		var nte;
		
		function createElement(tagName, parentTag)
		{
			if (!parentTag)
				return document.createElementNS("http://www.w3.org/2000/svg", tagName);
			if (parentTag.ownerDocument)
				return parentTag.ownerDocument.createElementNS("http://www.w3.org/2000/svg", tagName);
			return parentTag.document.createElementNS("http://www.w3.org/2000/svg", tagName);
		}

		function line(left, top, right, bottom, color, groupTag)
		{
			var lineObj = this.createElement("line", groupTag);
			lineObj.setAttribute("x1", left);
			lineObj.setAttribute("y1", top);
			lineObj.setAttribute("x2", right);
			lineObj.setAttribute("y2", bottom);
			lineObj.setAttribute("style", "shape-rendering:crispedges; stroke:" + color + "; stroke-width:1px");
			
			groupTag.appendChild(lineObj);
			
			return lineObj;
		}

		function animate(attributeName, from, to, dur, repeatCount, parentTag)
		{
			var animateObj = this.createElement("animate", parentTag);
			
			animateObj.setAttribute("attributeName", attributeName);
			animateObj.setAttribute("from", from);
			animateObj.setAttribute("to", to);
			animateObj.setAttribute("dur", dur);
			animateObj.setAttribute("repeatCount", repeatCount);
			animateObj.setAttribute("restart", "always");
			animateObj.setAttribute("fill", "freeze");

			parentTag.appendChild(animateObj);
	
			return animateObj;
		}

		function onLoad()
		{
			var p = document.createElement("span");

			p.innerHTML = 
				'<span class="caret" style="left: 0px; top: 16px; ">' + 
			  	//'<svg width="1px" height="19px">' + 
			    	//'<line id="caretLine" x1="0" y1="0" x2="1" y2="19" style="shape-rendering: crispedges; stroke: #000000; stroke-width: 1;">' + 
				    	//'<animate attributeName="visibility" from="visible" to="hidden" dur="1" repeatCount="indefinite" restart="always" fill="freeze"></animate>' + 
			    	//'</line>' + 
		  		//'</svg>' + 
  			'</span>';
  		p = p.children[0];
  		
			var nte = document.getElementById("naturaleditor");
			nte.insertBefore(p, nte.children[0]);
			
			p.innerHTML = 
				'<svg width="1px" height="19px">' + 
    			'<line id="caretLine" x1="0" y1="0" x2="1" y2="19" style="shape-rendering: crispedges; stroke: #000000; stroke-width: 1;">' + 
    			'<animate attributeName="visibility" from="visible" to="hidden" dur="1" repeatCount="indefinite" restart="always" fill="freeze"></animate>' + 
  				'</line>' + 
				'</svg>';
				
			p.innerHTML = "";
			p.innerHTML = 
				'<svg width="1px" height="19px">' + 
    			'<line id="caretLine" x1="0" y1="0" x2="1" y2="19" style="shape-rendering: crispedges; stroke: #000000; stroke-width: 1;">' + 
    			'<animate attributeName="visibility" from="visible" to="hidden" dur="1" repeatCount="indefinite" restart="always" fill="freeze"></animate>' + 
  				'</line>' + 
				'</svg>';

  		//var line = document.getElementById("caretLine");
  		//var an = animate("visibility", "visible", "hidden", "1", "indefinite", line);
  		//line.innerHTML = '<animate attributeName="visibility" from="visible" to="hidden" dur="1" repeatCount="indefinite" restart="always" fill="freeze"></animate>';
		}
	</script>
	
</body>

</html>